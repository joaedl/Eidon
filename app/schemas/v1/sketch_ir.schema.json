{
  "$defs": {
    "Profile": {
      "description": "Represents a closed profile region in a sketch (outer boundary or hole).",
      "properties": {
        "id": {
          "description": "Unique identifier for the profile",
          "title": "Id",
          "type": "string"
        },
        "type": {
          "description": "Profile type: outer boundary or inner hole",
          "enum": [
            "outer",
            "hole"
          ],
          "title": "Type",
          "type": "string"
        },
        "entity_ids": {
          "description": "IDs of entities that form this closed profile",
          "items": {
            "type": "string"
          },
          "title": "Entity Ids",
          "type": "array"
        },
        "area": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Calculated area of the profile (for sorting)",
          "title": "Area"
        },
        "is_outer": {
          "description": "True if this is the outer boundary, False if it's a hole",
          "title": "Is Outer",
          "type": "boolean"
        }
      },
      "required": [
        "id",
        "type",
        "entity_ids",
        "is_outer"
      ],
      "title": "Profile",
      "type": "object"
    },
    "SketchConstraint": {
      "description": "Represents a geometric constraint on sketch entities.",
      "properties": {
        "id": {
          "description": "Unique identifier for the constraint",
          "title": "Id",
          "type": "string"
        },
        "type": {
          "description": "Constraint type",
          "enum": [
            "horizontal",
            "vertical",
            "coincident"
          ],
          "title": "Type",
          "type": "string"
        },
        "entity_ids": {
          "description": "IDs of entities involved in the constraint",
          "items": {
            "type": "string"
          },
          "title": "Entity Ids",
          "type": "array"
        },
        "params": {
          "additionalProperties": true,
          "description": "Additional constraint parameters",
          "title": "Params",
          "type": "object"
        }
      },
      "required": [
        "id",
        "type",
        "entity_ids"
      ],
      "title": "SketchConstraint",
      "type": "object"
    },
    "SketchDimension": {
      "description": "Represents a dimension on sketch entities.",
      "properties": {
        "id": {
          "description": "Unique identifier for the dimension",
          "title": "Id",
          "type": "string"
        },
        "type": {
          "description": "Dimension type",
          "enum": [
            "length",
            "diameter"
          ],
          "title": "Type",
          "type": "string"
        },
        "entity_ids": {
          "description": "IDs of entities being dimensioned (1 or 2)",
          "items": {
            "type": "string"
          },
          "title": "Entity Ids",
          "type": "array"
        },
        "value": {
          "description": "Dimension value",
          "title": "Value",
          "type": "number"
        },
        "unit": {
          "default": "mm",
          "description": "Unit for the dimension",
          "title": "Unit",
          "type": "string"
        }
      },
      "required": [
        "id",
        "type",
        "entity_ids",
        "value"
      ],
      "title": "SketchDimension",
      "type": "object"
    },
    "SketchEntity": {
      "description": "Represents a 2D sketch entity (line, arc, circle, rectangle).",
      "properties": {
        "id": {
          "description": "Unique identifier for the entity",
          "title": "Id",
          "type": "string"
        },
        "type": {
          "description": "Entity type",
          "enum": [
            "line",
            "circle",
            "rectangle"
          ],
          "title": "Type",
          "type": "string"
        },
        "start": {
          "anyOf": [
            {
              "maxItems": 2,
              "minItems": 2,
              "prefixItems": [
                {
                  "type": "number"
                },
                {
                  "type": "number"
                }
              ],
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Start point (x, y) for line/arc",
          "title": "Start"
        },
        "end": {
          "anyOf": [
            {
              "maxItems": 2,
              "minItems": 2,
              "prefixItems": [
                {
                  "type": "number"
                },
                {
                  "type": "number"
                }
              ],
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "End point (x, y) for line/arc",
          "title": "End"
        },
        "center": {
          "anyOf": [
            {
              "maxItems": 2,
              "minItems": 2,
              "prefixItems": [
                {
                  "type": "number"
                },
                {
                  "type": "number"
                }
              ],
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Center point (x, y) for circle/arc",
          "title": "Center"
        },
        "radius": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Radius for circle/arc",
          "title": "Radius"
        },
        "corner1": {
          "anyOf": [
            {
              "maxItems": 2,
              "minItems": 2,
              "prefixItems": [
                {
                  "type": "number"
                },
                {
                  "type": "number"
                }
              ],
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "First corner for rectangle",
          "title": "Corner1"
        },
        "corner2": {
          "anyOf": [
            {
              "maxItems": 2,
              "minItems": 2,
              "prefixItems": [
                {
                  "type": "number"
                },
                {
                  "type": "number"
                }
              ],
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Second corner for rectangle",
          "title": "Corner2"
        }
      },
      "required": [
        "id",
        "type"
      ],
      "title": "SketchEntity",
      "type": "object"
    }
  },
  "description": "Sketch Intermediate Representation for 2D geometry. Contains entities (line, circle, rectangle), constraints (horizontal, vertical, coincident), and dimensions (length, diameter).",
  "properties": {
    "name": {
      "description": "Sketch name",
      "title": "Name",
      "type": "string"
    },
    "plane": {
      "description": "Plane reference. Can be: 'front_plane', 'right_plane', 'top_plane' (standard planes), or 'face:feature_name' (default face of a feature), or 'face:feature_name:index:N' (face by index, 0-based), or 'face:feature_name:normal:+X' (face with normal in +X direction), or 'face:feature_name:normal:[1,0,0]' (face with specific normal vector), or 'face:feature_name:center:[x,y,z]' (face containing point), or 'face:feature_name:largest' (largest face by area), or 'face:feature_name:smallest' (smallest face by area), or 'face:feature_name:top' (top face by Z), or 'face:feature_name:bottom' (bottom face by Z), or 'face:feature_name:front' (front face by Y), or 'face:feature_name:back' (back face by Y), or 'face:feature_name:right' (right face by X), or 'face:feature_name:left' (left face by X)",
      "title": "Plane",
      "type": "string"
    },
    "entities": {
      "description": "Sketch entities",
      "items": {
        "$ref": "#/$defs/SketchEntity"
      },
      "title": "Entities",
      "type": "array"
    },
    "constraints": {
      "description": "Geometric constraints",
      "items": {
        "$ref": "#/$defs/SketchConstraint"
      },
      "title": "Constraints",
      "type": "array"
    },
    "dimensions": {
      "description": "Dimensions",
      "items": {
        "$ref": "#/$defs/SketchDimension"
      },
      "title": "Dimensions",
      "type": "array"
    },
    "profiles": {
      "description": "Detected closed profiles (outer boundary and holes). Auto-detected if not provided.",
      "items": {
        "$ref": "#/$defs/Profile"
      },
      "title": "Profiles",
      "type": "array"
    }
  },
  "required": [
    "name",
    "plane"
  ],
  "title": "SketchIR",
  "type": "object",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://eidos.cad/schemas/v1/sketch_ir.schema.json"
}